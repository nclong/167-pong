<!doctype html>
<html>
<head>
	<meta charset='UTF-8' />

	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no"/>
  	<title>Space Pong : By VGDC</title>
  	<!-- MATERIALIZE CSS  -->
  	<link href="css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection"/>
  	<link href="css/style.css" type="text/css" rel="stylesheet" media="screen,projection"/>
  	<!-- my own css page -->
  	<link href="css/client.css" type="text/css" rel="stylesheet"/>
  	<link rel="icon" type="image/png" href="favicon.ico"/> 
  	<!-- REPLACE WITH YOUR OWN-->

  <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>

 <script> // Drawing script! 


 // RequestAnimFrame: a browser API for getting smooth animations


 // SET canvas properties here.
var cWidth;
var cHeight;
var display; // get a permanent reference to the permanent stuff.
var ctx; // the permanent display


var paddleOffset;
// game variables
var stepsize;
var player1Position;
var player1;


// Image

var board; 
var borderTop; 
var borderRight; 
var borderLeft; 
var borderBottom; 


function initialize() { // Drawing the start button
	
 // SET BACKGROUND canvas properties here.
	 cWidth = 1200;
	 cHeight = 500;

// Set stepsize here.
	stepsize = 30; // change as necessary.
	player1Position = cHeight/2;// always starts at the center.
	var tempString = "Space jam."; // set this temporarily

	player1 = document.getElementById("paddle1");
// Offsets here.

	paddleOffset = 100;

	display = document.getElementById("myCanvas"); // get a reference
 	ctx = display.getContext("2d");
 	

	ctx.font = "30px Arial";
	ctx.fillText(tempString,cWidth/2 - (tempString.length*9),cHeight/2);

// Draw the...  paddle
// Draw paddle2
 // var player2 = "images/paddle_blue.png";
 	var player2 = document.getElementById("paddle2");
	ctx.drawImage(player2, cWidth-100,(cHeight/2) - paddleOffset, 30, 100);

board = document.getElementById("bg");
 borderTop = document.getElementById("top-Border");
 borderRight = document.getElementById("right-Border"); 
 borderLeft = document.getElementById("right-Border"); // use the same!
 borderBottom = document.getElementById("bottom-Border");
	
drawGameBoard(); 
}
// 	


function drawGameBoard() // draws all the static elements.
{

ctx.drawImage(board, 0, 0, 1200, 500); // 0,0 width = 1200, height is 500 
ctx.drawImage(borderRight, 1180, 0, 20, 500);
ctx.drawImage(borderLeft, 0, 0, 20, 500);
ctx.drawImage(borderTop, 0, 0, 1200, 20); 
ctx.drawImage(borderBottom, 0, 480, 1200, 20);

// drawPaddle(); // draw the paddle.

}

function drawPaddle() // the value we get 
{
	 //mtx.clearRect(0, 0, cWidth, cHeight);
	ctx.drawImage(player1, 20, player1Position, 30, 100);
}


var ballVelocity;
var ballX;
var ballY;

function drawBall() // draw da ball.
{

}

function movePaddleUp()
{
	console.log("paddle Up command");
	 
	if(player1Position-stepsize > 0)
	{
		console.log("move up");
		player1Position-=stepsize;
	}

}

function movePaddleDown()
{
	if(player1Position+stepsize+100 < cHeight) // 500
		player1Position+=stepsize;
}


$(document).ready(function(){
	initialize();
	window.onkeydown = keyPress;
	//window.onkeyup = release;
	window.setInterval(drawGameBoard, 16); // draw the board.
	window.setInterval(drawPaddle, 16);
});



function keyPress(e)
{

if([32, 37, 38, 39, 40].indexOf(e.keyCode) > -1) {
        e.preventDefault();
    }

	if(e.keyCode == 38) {
        //alert('Up was pressed');
        movePaddleUp();
       
    }
    else if(e.keyCode == 40) {
        //alert('Down was pressed');
        movePaddleDown();
        
    }
}



</script>
</head>

<body class="grey lighten-3">

<!-- PUT THE CLIENT SIDE ASSETS HERE -->
<!-- THEY DO NOT DISPLAY -->
<!-- PADDLE SPRITE -->
	<img id="paddle1" src="images/Paddle.png" alt="paddle1"
	width="0" height="0">
	<img id="paddle2" src="images/Paddle2.png" alt="paddle1"
	width="0" height="0">
<!-- BALL SPRITE -->
	<img id="scream" src="img_the_scream.jpg" alt="The Scream"
	width="0" height="0">
<!-- CANVAS BACKGROUND -->
	<img id="bg" src="images/background.png" alt="bg"
	width="0" height="0">
	<img id="bottom-Border" src="images/Bottom.png" alt="bg"
	width="0" height="0">
	<img id="top-Border" src="images/Top.png" alt="bg"
	width="0" height="0">
	<img id="right-Border" src="images/Right.png" alt="bg"
	width="0" height="0">



<h1 class="center"> Space Pong </h1> <!-- Header -->

<!-- Input client IP and other things here -->
<div class="container valign-wrapper">
	<div class="row">
	  <form class="col s12">
	    <div class="row">
	      <div class="input-field col s6">
	        <i class="mdi-action-account-circle prefix"></i>
	        <input id='ip' name='ip' id="icon_prefix" type="text" class="validate">
	        <label for="icon_prefix">Server IP:</label>
	      </div>

	      <div class="input-field col s6">
	        <i class="mdi-communication-phone prefix"></i>
	        <input id='port' name='port' id="icon_telephone" type="text" class="validate">
	        <label for="icon_telephone">Server Port:</label>
	      </div>
	    </div>
	  </form>
	</div>
</div>

<!-- Hit the button to "begin" -->
<div class="container valign-wrapper"> <!-- Valign wrapper auto-centers -->
 <button class="btn red waves-effect waves-light" onclick="initialize()" type="submit" name="action">LET US PLAY PONG! <i class="mdi-content-send right"></i> 
  </button> 
</div>

<div class="container valign-wrapper">
			<canvas id="myCanvas"  width="1200" height="500" style="border:4px solid #000000;">
			</canvas>
</div>



<!-- Footer -->
  <footer class="grey darken-4">
    <div class="container">
      <div class="row"> 
      <p class="flow-text white-text">Made with love from VGDC</p>
      </div>
    </div>
    <div class="footer-copyright">
      <div class="container">
      This site was made with <a class="orange-text lighten-3" href="http://materializecss.com">Materialize.</a> Please check out their work!
      </div>
    </div>
  </footer>

  <!--OTHER Scripts-->
  <script src="js/materialize.js"></script>
  <script src="js/init.js"></script>

	<script src="fancywebsocket.js"></script> <!-- NEED THIS -->
	<script>
		var Server;

		function log( text ) {
			$log = $('#log');
			//Add text to log
			$log.append(($log.val()?"\n":'')+text);
			//Autoscroll
			$log[0].scrollTop = $log[0].scrollHeight - $log[0].clientHeight;
		}

		function send( text ) {
			Server.send( 'message', text );
		}

        function connect(){
            log('Connecting...');
			Server = new FancyWebSocket('ws://' + document.getElementById('ip').value + ':' + document.getElementById('port').value);

			$('#message').keypress(function(e) {
				if ( e.keyCode == 13 && this.value ) {
					log( 'You: ' + this.value );
					send( this.value );

					$(this).val('');
				}
			});

			//Let the user know we're connected
			Server.bind('open', function() {
                document.getElementById("cntBtn").disabled = true;
				log( "Connected." );
			});

			//OH NOES! Disconnection occurred.
			Server.bind('close', function( data ) {
                document.getElementById("cntBtn").disabled = false;
				log( "Disconnected." );
			});

			//Log any messages sent from server
			Server.bind('message', function( payload ) {
				log( payload );
			});

			Server.connect();
        }

	</script>
     


</body>

</html>
